# Flatpak

The [OpenMadoola Flatpak](https://flathub.org/apps/com.infochunk.OpenMadoola) has a few differences from the standard binary due to sandboxing.

## Data files

All redistributable data files from this repo are bundled with the Flatpak, similar to the Windows builds. When you run the OpenMadoola Flatpak for the first time, a script will walk you through loading your Wing of Madoola game ROM data.

All files generated by you playing the game (saves, configuration information, etc.) are stored at `~/.var/app/com.infochunk.OpenMadoola/data/openmadoola/`.

## Steam Deck

If you're playing OpenMadoola on the Steam Deck, make sure you play it in the fullscreen Steam interface rather than in desktop mode. After installing OpenMadoola, right-click on the shortcut and click "Add to Steam". Then, click "Return to Gaming Mode" and run OpenMadoola from the "non-Steam" section of your library. If you run OpenMadoola while you're in desktop mode, pressing buttons on the controller will send both gamepad inputs and keyboard inputs at the same time, which confuses OpenMadoola's input handling code. This means that if you try to remap your controls while in desktop mode, you will probably mess up the key bindings. If this happens, delete the "config.db" file from `~/.var/app/com.infochunk.OpenMadoola/data/openmadoola/`.

## MML compiler

Due to sandboxing, you can only play MML files that are in `~/.var/app/com.infochunk.OpenMadoola/data/openmadoola/`. If you're working on an MML file and want to use the standalone player, copy the file into that directory, then open a terminal there. You can play the MML file by running `flatpak run com.infochunk.OpenMadoola -p file.mml`. If you're interested in overriding in-game music or sounds with your MML file, create the directory `~/.var/app/com.infochunk.OpenMadoola/data/openmadoola/mml` and then copy your files inside that directory following the names [here](https://github.com/nfroggy/openmadoola/blob/master/src/sound.c) (search for "soundFilenames").
